<h1 class="page-header">Zapisz bitwę Warmachine & Hordes</h1>
<div *ngIf="!spinnerModel.armiesLoaded && !spinnerModel.scenariosLoaded && !spinnerModel.playersLoaded" class=""><spinner></spinner></div>
<div>
    <div *ngIf="spinnerModel.armiesLoaded && spinnerModel.scenariosLoaded && spinnerModel.playersLoaded" class="row  addBattleWrapper warmachine-component">
        <div class="systemWrapper col-xl-4 col-lg-4 col-md-6 col-sm-12 col-12 mb-3 p-3 container">
            <div class="row">
                <div class="col-6">
                    <h4 class="header">Format</h4>
                    <select type="number" name="army" [(ngModel)]="requestModel.pointFormat" (change)="UpdateScenario(requestModel.scenarioID)" class="systemFont col-sm-12 col-12">
                        <option type="number" value="0">0</option>
                        <option type="number" value="10">10</option>
                        <option type="number" value="15">15</option>
                        <option type="number" value="20">20</option>
                        <option type="number" value="25">25</option>
                        <option type="number" value="35">35</option>
                        <option type="number" value="50">50</option>
                        <option type="number" value="65">65</option>
                        <option type="number" value="75">75</option>
                    </select>
                </div>
                <div class="col-6">
                    <h4 class="header">Rundy</h4>
                    <input type="number" min="1" max="5" id="roundInput" [(ngModel)]="requestModel.rounds" class="labelCount text-center" />
                </div>
            </div>
            <div class="row">
                <div class="col">
                    <h4 class="header">Steamroller 2019</h4>
                    <select name="army" [ngClass]="{'invalid': requestModel.scenarioID == 0}" [(ngModel)]="requestModel.scenarioID" (change)="UpdateScenario(requestModel.scenarioID)" class="col col-sm-12 col-12">
                        <option value="0">---</option>
                        <option *ngFor="let scenario of dataModel.scenarios" [value]="scenario.scenarioID">{{scenario.scenarioName}}</option>
                    </select>
                    <div class="mt-3" *ngIf="requestModel.scenarioID != 0" style="border-radius:10px; overflow:hidden; max-height:600px">
                        <img src="{{formModel.scenarioImgUrl}}" style="width:100%;" />
                    </div>
                </div>
            </div>
            <br />
        </div>
        <div class="col-xl-8 col-lg-8 col-md-6 col-sm-12 col- playerScoreWrapper">
            <div class="playerWrapper container mb-3 p-3 col-sm-12 col-12">
                <div class="playerSection text-center">
                    <h2 class="header">{{formModel.loggedUserName}}</h2>
                </div>
                <div class="row">
                    <div class="armyImageWrapper col-xl-4 col-lg-4 col-md-12 col-sm-12 col-12 my-3">
                        <div class="biggerArmyIco position-relative" [ngStyle]="{'background-image': formModel.armyImg.player1 }">
                            <div class="smallerArmyIco position-absolute absolute" [ngStyle]="{'background-image': formModel.casterImg.player1, 'background-size': 'cover', 'border-radius': '100%'}"></div>
                        </div>

                    </div>
                    <div class="armySection col-xl-5 col-lg-5 col-md-12 col-sm-12 col-12">
                        <p>Wybierz armię:</p>
                        <select name="army" [ngClass]="{'invalid': requestModel.playerList[0].armyID == 0}" (change)="ArmyChanged($event.target.value, 'player1', 0)" class="col col-sm-12 col-12">
                            <option value="0">---</option>
                            <option *ngFor="let army of formModel.armyPool.player1" [value]="army.armyID">{{army.armyName}}</option>
                        </select>
                        <p>Wybierz castera:</p>
                        <select name="caster" [ngClass]="{'invalid': requestModel.playerList[0].casterID == 0}" (change)="CasterChanged($event.target.value, 'player1', 0)" class="col col-sm-12 col-12">
                            <option value="0">---</option>
                            <option *ngFor="let caster of formModel.availableCasters.player1" [value]="caster.casterID">{{caster.casterName}}</option>
                        </select>
                        <p>Wybierz theme:</p>
                        <select name="theme" class="col col-sm-12 col-12" (change)="ThemeChanged($event.target.value, 0)">
                            <option value="0">---</option>
                            <option *ngFor="let theme of formModel.availableThemes.player1" value="{{theme.themeID}}">{{theme.themeName}}</option>
                        </select>
                        <div class="my-3">
                            <div (click)="CheckboxUpdated(0, 2)" class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12 float-left clickable p-0">
                                <div [ngClass]="{'checked': (requestModel.playerList[0].winCondition == 2)}" class="checkbox float-left" name=""></div>
                                <p class="float-left pl-3">Wygrana: Caster Kill</p>
                            </div>
                            <div (click)="CheckboxUpdated(0, 3)" class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12 float-left clickable p-0">
                                <div [ngClass]="{'checked': (requestModel.playerList[0].winCondition == 3)}" class="checkbox float-left" name=""></div>
                                <p class="float-left pl-3">Wygrana: Death Clock</p>
                            </div>
                            <div class="clear"></div>
                        </div>

                    </div>

                    <div class="resultSection col-xl-3 col-lg-3 col-md-12 col-sm-12 col-12">
                        <div class="row">
                            <div class="col-xl-12 col-lg-12 col-md-6 col-sm-6 col-6 col-md-6">
                                <p class="calculateLabel text-center">Objective Points</p>
                                <input id="objectiveInputP1" type="number" min="0" max="20" class="labelCount text-center" [(ngModel)]="requestModel.playerList[0].objectivePoints" />
                            </div>
                            <div class="col-xl-12 col-lg-12 col-md-6 col-sm-6 col-6 col-md-6">
                                <p class="calculateLabel text-center">Army Points</p>
                                <input id="armyInputP1" type="number" min="0" max="{{requestModel.pointFormat}}" [(ngModel)]="requestModel.playerList[0].armyPoints" class="labelCount text-center" />
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="playerWrapper container  p-3 col-sm-12 col-12">
                <p>Wybierz przeciwnika:</p>
                <div class="playerSection text-center">
                    <select name="army" [ngClass]="{'invalid': requestModel.playerList[1].playerID == 0}" class="col col-sm-12 col-12" (change)="OpponentChanged($event.target.value)">
                        <option value="0">---</option>
                        <option *ngFor="let player of dataModel.players" [value]="player.playerID">{{player.fullName}}</option>
                    </select>
                </div>
                <div class="row">
                    <div class="armyImageWrapper col-xl-4 col-lg-4 col-md-12 col-sm-12 col-12 my-3 ">
                        <div class="biggerArmyIco position-relative" [ngStyle]="{'background-image': formModel.armyImg.player2 }">
                            <div class="smallerArmyIco position-absolute absolute" [ngStyle]="{'background-image': formModel.casterImg.player2, 'background-size': 'cover', 'border-radius': '100%'}"></div>
                        </div>

                    </div>
                    <div class="armySection col-xl-5 col-lg-5 col-md-12 col-sm-12 col-12">
                        <p>Wybierz armię:</p>
                        <select name="army" [ngClass]="{'invalid': requestModel.playerList[1].armyID == 0}" (change)="ArmyChanged($event.target.value, 'player2', 1)" class="col col-sm-12 col-12">
                            <option value="0">---</option>
                            <option *ngFor="let army of formModel.armyPool.player2" [value]="army.armyID">{{army.armyName}}</option>
                        </select>
                        <p>Wybierz castera:</p>
                        <select name="caster" [ngClass]="{'invalid': requestModel.playerList[1].casterID == 0}" (change)="CasterChanged($event.target.value, 'player2', 1)" class="col col-sm-12 col-12">
                            <option value="0">---</option>
                            <option *ngFor="let caster of formModel.availableCasters.player2" [value]="caster.casterID">{{caster.casterName}}</option>
                        </select>
                        <p>Wybierz theme:</p>
                        <select name="theme" class="col col-sm-12 col-12" (change)="ThemeChanged($event.target.value, 1)">
                            <option value="0">---</option>
                            <option *ngFor="let theme of formModel.availableThemes.player2" value="{{theme.themeID}}">{{theme.themeName}}</option>
                        </select>

                        <div class="my-3">
                            <div (click)="CheckboxUpdated(1, 2)" class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12 float-left clickable p-0">
                                <div [ngClass]="{'checked': (requestModel.playerList[1].winCondition == 2)}" class="checkbox float-left" name=""></div>
                                <p class="float-left pl-3">Wygrana: Caster Kill</p>
                            </div>
                            <div (click)="CheckboxUpdated(1, 3)" class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12 float-left clickable p-0">
                                <div [ngClass]="{'checked': (requestModel.playerList[1].winCondition == 3)}" class="checkbox float-left" name=""></div>
                                <p class="float-left pl-3">Wygrana: Death Clock</p>
                            </div>
                            <div class="clear"></div>

                        </div>

                    </div>

                    <div class="resultSection col-xl-3 col-lg-3 col-md-12 col-sm-12 col-12">
                        <div class="row">
                            <div class="col-xl-12 col-lg-12 col-md-6 col-sm-6 col-6 col-md-6">
                                <p class="calculateLabel text-center">Objective Points</p>
                                <input id="objectiveInputP2" type="number" min="0" max="10" class="labelCount text-center" [(ngModel)]="requestModel.playerList[1].objectivePoints" />
                            </div>
                            <div class="col-xl-12 col-lg-12 col-md-6 col-sm-6 col-6 col-md-6">
                                <p class="calculateLabel text-center">Army Points</p>
                                <input id="armyInputP2" type="number" min="0" max="{{requestModel.pointFormat}}" [(ngModel)]="requestModel.playerList[1].armyPoints" class="labelCount text-center" />
                            </div>
                        </div>
                    </div>
                </div>

            </div>


        </div>
    </div>
    <div *ngIf="!spinnerModel.submitLoaded" class="mt-3 col-xl-4 col-lg-4 col-md-12 col-sm-12 col-12 float-right"><spinner></spinner></div>

    <button *ngIf="spinnerModel.submitLoaded" [disabled]="!formModel.validation.scenarioValid || !formModel.validation.opponentValid" [ngClass]="{'activeBtn' : IsFormValid(), 'inactiveBtn' : !IsFormValid()}" class="col-xl-4 col-lg-4 col-md-12 col-sm-12 col-12 float-right mt-3" (click)="SubmitResult()">Wyślij wynik</button>
</div>
